/*! dxtpl by DXkite 2016-12-14 */
!function(a){function b(a,b){try{new Function(a)}catch(a){return"throw "+a.name+"("+e(a.message)+");{"}return b}function c(a,b){var c="";return a.match(/(?!^)\n/)?t(a.split("\n"),function(a){a&&(b&&(a=a.replace(/\s+/g," ").replace(/<!--.*?-->/g,"")),a&&(c+=p[1]+e(a)+p[2],c+="\n"))}):a&&(c+=p[1]+e(a)+p[2]),c}function d(a){var c;if(!(c=a.match(new RegExp(o))))return(c=a.match(/^!.*$/))?p[1]+"$_unit._echo("+c[1]+")"+p[2]:p[1]+"$_unit._escape("+a+")"+p[2];var d=c[1],e=c[2];switch(d){case"include":return e=e.trim().split(" "),1===e.length&&e.push("$_unit.value"),e=e.join(","),p[1]+"$_unit._include("+e+")"+p[2];case"if":return b("if("+e+"){}","if ("+e+") {");case"else":return(c=e.match(/^\s*if\s+(.*)/))?"} else if ("+c[1]+"){":"}else{";case"/if":case"/while":case"/for":return"}";case"while":return b("while("+e+"){}","while ("+e+") {");case"for":return b("for("+e+"){}","for ("+e+") {");case"each":var c=e.match(/(\w+)\s+(?:(?:as(?:\s+(\w+)))?(?:(?:\s+=>)?\s+(\w+))?)?/);if(c){var f,g=c[1];return f=c[2]?c[3]?c[3]+","+c[2]:c[2]:"value,index","$_unit._each("+g+",function("+f+"){"}return'throw SyntaxError("Null Each Value");$_unit._each(null,function(){';case"/each":return"});"}}function e(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(a,b,c,d){var a=a||"anonymous",e="DxTPL Error:";if(console.group(e),b){var f=b.replace(/^\n/,"").split("\n"),g=c-5>0?c-5:1,h=c+5>f.length?f.length:c+5;console.error(d);for(var i=g;i<h;i++)i==c?console.log(i+"|%c"+f[c-1]+"\t\t%c->\t\t%c"+d.name+":"+d.message,"color:red;","color:green;","color:red;"):console.log(i+"|"+f[i-1])}else console.log(b),console.log("%c"+e+d.message+"\t\t@"+a+":"+c,"color:red;");console.groupEnd(e)}function h(a,b){var e="";return a=a.replace(/^\n/,""),t(a.split(b.tagstart),function(a){var f=a.split(b.tagend);1===f.length?e+=c(f[0],b.compress):(e+=d(f[0]),e+=c(f[1]))}),e}function i(a,b,c){var d=void 0===c||c,e=[];e.push("var $_unit=this,"+p[0]);for(var f in b)e.push(f+"=this.value."+f);var g="";return d&&(g='"use strict";'),g+=e.join(","),g+=";",g+=a+"return new String("+p[3]+");"}function j(a,b,c,d,e){var f,h=i(c,d,e),j={_each:t,_echo:r,_escape:s,_include:w,value:d};try{var k=new Function(h);f=k.call(j)}catch(c){var l=new String(c.stack).match(/<anonymous>:(\d+):\d+/);if(l){var m=l[1]-1;g(a,b,m,c)}else{var a=a||"anonymous",l=new String(c.stack).match(/Function code:(\d+):\d+/);l?console.error("DxTPL:Compile Error@"+a+" Line "+l[1]):console.error("DxTPL:Compile Error@"+a)}}return f}function k(a,b){var c=document.getElementById("template_caches");c||(c=document.createElement("div"),c.id="template_caches",c.style.display="none",document.body.appendChild(c));var d="template_cache_"+a,e=document.getElementById("template_cache_"+a);return e||(e=document.createElement("div"),e.id=d,e.innerText=h(document.getElementById(a).innerHTML,b||m),c.appendChild(e)),e.innerText}function l(a,b){var c=a||b.id;if("string"!=typeof c)throw Error("Unsupport Template ID");var d=document.getElementById(c);return b.source=d.innerHTML,b.code||(b.cache?b.code=k(c,b):b.code=h(source,b)),b}var m={cache:!0,tagstart:"{",tagend:"}",compress:!0,strict:!0},n="if,else,each,include,while,for",o="^\\s*((?:/)?(?:"+n.split(",").join("|")+"))(.*)",p="".trim?["$_tpl_=''","$_tpl_+=",";","$_tpl_"]:["$_tpl_=[]","$_tpl_.push(",");","$_tpl_.join('')"],q={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},r=function(a){return new String(a)},s=function(a){return r(a).replace(/&(?![\w#]+;)|[<>"']/g,function(a){return q[a]})},t=function(a,b){if(f(a))u(a,b);else for(var c in a)b.call(a[c],a[c],c)},u=function(a,b){for(var c=0;c<a.length;++c)b.call(a[c],a[c],c)},v=function(a){for(var b={},c=0;c<arguments.length;c++)for(var d in arguments[c])b[d]=arguments[c][d];return b},w=function(a,b){if(!document.getElementById(a))throw Error("No Template "+a);try{var c=new template(a,b);return c instanceof String?c:"[Error Template "+a+"]"}catch(a){throw a}},x=function(a){var b=v(m,a);if(this.source=b.source,this.code=b.code,this.config(b),b.id){var c=l(b.id,b);this.config(c)}};x.prototype.config=function(a){for(var b in a)this[b]=a[b]},x.prototype.assign=function(a,b){this.value[a]=v(this.value[a],b)},x.prototype.value=function(a){this.value=v(this.value,a)},x.prototype.compile=function(a){var b=v(this,l(a,this));return new x(b)},x.prototype.render=function(a){return this.source&&this.code?j(this.id,this.source,this.code,a,this.strict):void console.error("Uncompile Template")},x.template=function(a,b){var c=document.querySelectorAll(a),d=this;u(c,function(b,c){var e,f=b.innerHTML;if(b.dataset.tplInit)try{var i=new Function("return "+b.dataset.tplInit+";");e=i()}catch(b){g(a+"["+c+"]",null,0,new Error("Unsupport json"))}e=v(e,glo_value);var k;d.template[a]?k=d.template[a]:(k=h(f,d),d.template[a]=k),console.log(k),b.innerHTML=j(a,f,k,e)})},a.dxtpl=new x,a.dxtpl.Template=x}(window);